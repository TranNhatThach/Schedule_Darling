<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="logo.png">
    <title>Schedule Darling</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .schedule-cell {
            min-height: 80px;
            transition: all 0.2s ease;
            margin: 2px;
            border-radius: 8px;
            border: 1px solid #e5e7eb !important;
        }
        .schedule-cell:hover {
            transform: scale(1.02);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        .schedule-table {
            border-spacing: 4px;
            border-collapse: separate;
        }
        .time-slot {
            writing-mode: vertical-rl;
            text-orientation: mixed;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen p-4">
    <div class="flex gap-6 max-w-7xl mx-auto">
        <!-- Sidebar b√™n tr√°i (25%) -->
        <div class="w-1/4 bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">Hi Darling üíï</h2>
            
            <div class="space-y-4">
                <!-- ·∫¢nh ƒë·∫°i di·ªán -->
                <div class="bg-pink-50 p-4 rounded-lg text-center">
                    <div class="w-32 h-32 mx-auto mb-3 bg-gradient-to-br from-pink-200 to-purple-200 rounded-2xl flex items-center justify-center cursor-pointer hover:scale-105 transition-transform overflow-hidden shadow-lg" onclick="selectImage()">
                        <span class="text-3xl" id="avatarDisplay">üì∏</span>
                        <img id="userAvatar" class="w-full h-full object-cover rounded-2xl hidden" alt="Avatar" style="image-rendering: -webkit-optimize-contrast; image-rendering: crisp-edges;">
                    </div>
                    <input type="file" id="imageInput" accept="image/*" class="hidden" onchange="handleImageUpload(event)">
                    <p class="text-xs text-pink-600">Nh·∫•p ƒë·ªÉ t·∫£i ·∫£nh l√™n</p>
                    <button onclick="changeAvatar()" class="text-xs text-purple-600 hover:text-purple-800 mt-1 block mx-auto">
                        Ho·∫∑c d√πng emoji
                    </button>
                </div>
                
                <!-- L·ªãch nh·ªè -->
                <div class="bg-white border-2 border-gray-200 rounded-lg p-4">
                    <div class="text-center mb-3">
                        <h3 class="font-bold text-gray-800" id="calendarMonth"></h3>
                        <p class="text-sm text-gray-600" id="calendarYear"></p>
                    </div>
                    
                    <!-- C√°c ng√†y trong tu·∫ßn -->
                    <div class="grid grid-cols-7 gap-1 mb-2">
                        <div class="text-xs text-center font-medium text-gray-500 py-1">T2</div>
                        <div class="text-xs text-center font-medium text-gray-500 py-1">T3</div>
                        <div class="text-xs text-center font-medium text-gray-500 py-1">T4</div>
                        <div class="text-xs text-center font-medium text-gray-500 py-1">T5</div>
                        <div class="text-xs text-center font-medium text-gray-500 py-1">T6</div>
                        <div class="text-xs text-center font-medium text-gray-500 py-1">T7</div>
                        <div class="text-xs text-center font-medium text-gray-500 py-1">CN</div>
                    </div>
                    
                    <!-- C√°c ng√†y trong th√°ng -->
                    <div class="grid grid-cols-7 gap-1" id="calendarDays">
                        <!-- S·∫Ω ƒë∆∞·ª£c t·∫°o b·∫±ng JavaScript -->
                    </div>
                </div>
                
                <div class="space-y-2">
                    <button onclick="clearSchedule()" class="w-full bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg transition-colors">
                        X√≥a T·∫•t C·∫£
                    </button>
                    <button onclick="exportSchedule()" class="w-full bg-green-500 hover:bg-green-600 text-white py-2 px-4 rounded-lg transition-colors">
                        Xu·∫•t L·ªãch
                    </button>
                </div>
            </div>
        </div>

        <!-- B·∫£ng l·ªãch b√™n ph·∫£i (75%) -->
        <div class="w-3/4 bg-white rounded-xl shadow-lg overflow-hidden">
            <div class="bg-gradient-to-r from-blue-600 to-indigo-600 text-white p-6">
                <h1 class="text-3xl font-bold">Th·ªùi Gian Bi·ªÉu C·ªßa Darling</h1>
                <p class="text-blue-100 mt-2">Nh·∫•p v√†o √¥ ƒë·ªÉ th√™m/ch·ªânh s·ª≠a s·ª± ki·ªán</p>
            </div>
            
            <div class="overflow-x-auto">
                <table class="w-full schedule-table">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="p-4 text-left font-semibold text-gray-700 border-b">Ca H·ªçc</th>
                            <th class="p-4 text-center font-semibold text-gray-700 border-b">Th·ª© 2</th>
                            <th class="p-4 text-center font-semibold text-gray-700 border-b">Th·ª© 3</th>
                            <th class="p-4 text-center font-semibold text-gray-700 border-b">Th·ª© 4</th>
                            <th class="p-4 text-center font-semibold text-gray-700 border-b">Th·ª© 5</th>
                            <th class="p-4 text-center font-semibold text-gray-700 border-b">Th·ª© 6</th>
                            <th class="p-4 text-center font-semibold text-gray-700 border-b">Th·ª© 7</th>
                            <th class="p-4 text-center font-semibold text-gray-700 border-b">Ch·ªß Nh·∫≠t</th>
                        </tr>
                    </thead>
                    <tbody id="scheduleTable">
                        <!-- Ca 1: 7:00 - 9:30 -->
                        <tr>
                            <td class="p-4 bg-blue-50 border-b font-medium text-blue-800">
                                <div class="text-sm">Ca 1</div>
                                <div class="text-xs text-blue-600">7:00 - 9:30</div>
                            </td>
                            <td class="schedule-cell cursor-pointer hover:bg-blue-50" onclick="editCell(this, 'Ca 1', 'Th·ª© 2')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-blue-50" onclick="editCell(this, 'Ca 1', 'Th·ª© 3')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-blue-50" onclick="editCell(this, 'Ca 1', 'Th·ª© 4')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-blue-50" onclick="editCell(this, 'Ca 1', 'Th·ª© 5')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-blue-50" onclick="editCell(this, 'Ca 1', 'Th·ª© 6')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-blue-50" onclick="editCell(this, 'Ca 1', 'Th·ª© 7')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-blue-50" onclick="editCell(this, 'Ca 1', 'Ch·ªß Nh·∫≠t')"></td>
                        </tr>
                        
                        <!-- Ca 2: 9:40 - 11:45 -->
                        <tr>
                            <td class="p-4 bg-green-50 border-b font-medium text-green-800">
                                <div class="text-sm">Ca 2</div>
                                <div class="text-xs text-green-600">9:40 - 11:45</div>
                            </td>
                            <td class="schedule-cell cursor-pointer hover:bg-green-50" onclick="editCell(this, 'Ca 2', 'Th·ª© 2')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-green-50" onclick="editCell(this, 'Ca 2', 'Th·ª© 3')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-green-50" onclick="editCell(this, 'Ca 2', 'Th·ª© 4')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-green-50" onclick="editCell(this, 'Ca 2', 'Th·ª© 5')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-green-50" onclick="editCell(this, 'Ca 2', 'Th·ª© 6')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-green-50" onclick="editCell(this, 'Ca 2', 'Th·ª© 7')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-green-50" onclick="editCell(this, 'Ca 2', 'Ch·ªß Nh·∫≠t')"></td>
                        </tr>
                        
                        <!-- Ca 3: 13:00 - 15:30 -->
                        <tr>
                            <td class="p-4 bg-yellow-50 border-b font-medium text-yellow-800">
                                <div class="text-sm">Ca 3</div>
                                <div class="text-xs text-yellow-600">13:00 - 15:30</div>
                            </td>
                            <td class="schedule-cell cursor-pointer hover:bg-yellow-50" onclick="editCell(this, 'Ca 3', 'Th·ª© 2')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-yellow-50" onclick="editCell(this, 'Ca 3', 'Th·ª© 3')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-yellow-50" onclick="editCell(this, 'Ca 3', 'Th·ª© 4')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-yellow-50" onclick="editCell(this, 'Ca 3', 'Th·ª© 5')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-yellow-50" onclick="editCell(this, 'Ca 3', 'Th·ª© 6')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-yellow-50" onclick="editCell(this, 'Ca 3', 'Th·ª© 7')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-yellow-50" onclick="editCell(this, 'Ca 3', 'Ch·ªß Nh·∫≠t')"></td>
                        </tr>
                        
                        <!-- Ca 4: 15:40 - 17:45 -->
                        <tr>
                            <td class="p-4 bg-purple-50 border-b font-medium text-purple-800">
                                <div class="text-sm">Ca 4</div>
                                <div class="text-xs text-purple-600">15:40 - 17:45</div>
                            </td>
                            <td class="schedule-cell cursor-pointer hover:bg-purple-50" onclick="editCell(this, 'Ca 4', 'Th·ª© 2')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-purple-50" onclick="editCell(this, 'Ca 4', 'Th·ª© 3')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-purple-50" onclick="editCell(this, 'Ca 4', 'Th·ª© 4')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-purple-50" onclick="editCell(this, 'Ca 4', 'Th·ª© 5')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-purple-50" onclick="editCell(this, 'Ca 4', 'Th·ª© 6')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-purple-50" onclick="editCell(this, 'Ca 4', 'Th·ª© 7')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-purple-50" onclick="editCell(this, 'Ca 4', 'Ch·ªß Nh·∫≠t')"></td>
                        </tr>
                        
                        <!-- Ca 5: 19:45 - 22:25 -->
                        <tr>
                            <td class="p-4 bg-red-50 border-b font-medium text-red-800">
                                <div class="text-sm">Ca 5</div>
                                <div class="text-xs text-red-600">19:45 - 22:25</div>
                            </td>
                            <td class="schedule-cell cursor-pointer hover:bg-red-50" onclick="editCell(this, 'Ca 5', 'Th·ª© 2')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-red-50" onclick="editCell(this, 'Ca 5', 'Th·ª© 3')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-red-50" onclick="editCell(this, 'Ca 5', 'Th·ª© 4')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-red-50" onclick="editCell(this, 'Ca 5', 'Th·ª© 5')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-red-50" onclick="editCell(this, 'Ca 5', 'Th·ª© 6')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-red-50" onclick="editCell(this, 'Ca 5', 'Th·ª© 7')"></td>
                            <td class="schedule-cell cursor-pointer hover:bg-red-50" onclick="editCell(this, 'Ca 5', 'Ch·ªß Nh·∫≠t')"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal ƒë·ªÉ ch·ªânh s·ª≠a -->
    <div id="editModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 w-96 max-w-90vw">
            <h3 class="text-xl font-bold mb-4" id="modalTitle">Ch·ªânh S·ª≠a S·ª± Ki·ªán</h3>
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">T√™n S·ª± Ki·ªán</label>
                    <input type="text" id="subjectInput" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nh·∫≠p t√™n s·ª± ki·ªán...">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">M√¥ T·∫£ Chi Ti·∫øt</label>
                    <textarea id="teacherInput" rows="6" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none" placeholder="Nh·∫≠p m√¥ t·∫£ chi ti·∫øt v·ªÅ s·ª± ki·ªán (t·ªëi ƒëa 300 t·ª´)..." maxlength="1500"></textarea>
                    <p class="text-xs text-gray-500 mt-1">C√≤n l·∫°i: <span id="charCount">1500</span> k√Ω t·ª±</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">ƒê·ªãa ƒêi·ªÉm</label>
                    <input type="text" id="roomInput" class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="Nh·∫≠p ƒë·ªãa ƒëi·ªÉm...">
                </div>
            </div>
            <div class="flex gap-3 mt-6">
                <button onclick="saveCell()" class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-lg transition-colors">
                    L∆∞u
                </button>
                <button onclick="deleteCell()" class="flex-1 bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg transition-colors">
                    X√≥a
                </button>
                <button onclick="closeModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 px-4 rounded-lg transition-colors">
                    H·ªßy
                </button>
            </div>
        </div>
    </div>
    <script src="api.js"></script>
    <script>
        let currentCell = null;
        let scheduleData = {};

        function editCell(cell, period, day) {
            currentCell = cell;
            const key = `${period}-${day}`;
            const data = scheduleData[key] || {};
            
            document.getElementById('modalTitle').textContent = `${period} - ${day}`;
            document.getElementById('subjectInput').value = data.subject || '';
            document.getElementById('teacherInput').value = data.teacher || '';
            document.getElementById('roomInput').value = data.room || '';
            
            document.getElementById('editModal').classList.remove('hidden');
            document.getElementById('editModal').classList.add('flex');
            document.getElementById('subjectInput').focus();
        }

        function saveCell() {
            const subject = document.getElementById('subjectInput').value.trim();
            const teacher = document.getElementById('teacherInput').value.trim();
            const room = document.getElementById('roomInput').value.trim();
            
            if (!subject) {
                alert('Vui l√≤ng nh·∫≠p t√™n s·ª± ki·ªán!');
                return;
            }
            
            const period = document.getElementById('modalTitle').textContent.split(' - ')[0];
            const day = document.getElementById('modalTitle').textContent.split(' - ')[1];
            const key = `${period}-${day}`;
            
            scheduleData[key] = { subject, teacher, room };
            saveSchedule(); 
            currentCell.innerHTML = `
                <div class="p-2">
                    <div class="font-semibold text-sm text-gray-800">${subject}</div>
                    ${teacher ? `<div class="text-xs text-gray-600 line-clamp-2">${teacher.substring(0, 100)}${teacher.length > 100 ? '...' : ''}</div>` : ''}
                    ${room ? `<div class="text-xs text-gray-500">üìç ${room}</div>` : ''}
                </div>
            `;
            
            currentCell.classList.add('bg-blue-100');
            
            closeModal();
            updateStats();
        }

        function deleteCell() {
            const period = document.getElementById('modalTitle').textContent.split(' - ')[0];
            const day = document.getElementById('modalTitle').textContent.split(' - ')[1];
            const key = `${period}-${day}`;
            
            delete scheduleData[key];
            saveSchedule();
            currentCell.innerHTML = '';
            currentCell.classList.remove('bg-blue-100', 'bg-green-100', 'bg-yellow-100', 'bg-purple-100', 'bg-red-100');
            
            closeModal();
            updateStats();
        }

        function closeModal() {
            document.getElementById('editModal').classList.add('hidden');
            document.getElementById('editModal').classList.remove('flex');
            currentCell = null;
        }

        function clearSchedule() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a to√†n b·ªô l·ªãch h·ªçc?')) {
                scheduleData = {};
                const cells = document.querySelectorAll('.schedule-cell');
                cells.forEach(cell => {
                    cell.innerHTML = '';
                    cell.classList.remove('bg-blue-100', 'bg-green-100', 'bg-yellow-100', 'bg-purple-100', 'bg-red-100');
                });
                updateStats();
            }
        }

        function exportSchedule() {
            const scheduleText = Object.entries(scheduleData)
                .map(([key, data]) => {
                    return `${key}: ${data.subject}${data.teacher ? ` - GV: ${data.teacher}` : ''}${data.room ? ` - Ph√≤ng: ${data.room}` : ''}`;
                })
                .join('\n');
            
            const blob = new Blob([scheduleText], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'lich-hoc-tuan.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        function updateStats() {
            // Ch·ªâ c·∫ßn c·∫≠p nh·∫≠t l·ªãch nh·ªè
            updateMiniCalendar();
        }

        // T·∫°o l·ªãch nh·ªè
        function updateMiniCalendar() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            const today = now.getDate();
            
            // C·∫≠p nh·∫≠t th√°ng v√† nƒÉm
            const monthNames = ['Th√°ng 1', 'Th√°ng 2', 'Th√°ng 3', 'Th√°ng 4', 'Th√°ng 5', 'Th√°ng 6',
                               'Th√°ng 7', 'Th√°ng 8', 'Th√°ng 9', 'Th√°ng 10', 'Th√°ng 11', 'Th√°ng 12'];
            document.getElementById('calendarMonth').textContent = monthNames[currentMonth];
            document.getElementById('calendarYear').textContent = currentYear;
            
            // T√≠nh to√°n ng√†y ƒë·∫ßu th√°ng v√† s·ªë ng√†y trong th√°ng
            const firstDay = new Date(currentYear, currentMonth, 1);
            const lastDay = new Date(currentYear, currentMonth + 1, 0);
            const daysInMonth = lastDay.getDate();
            const startingDayOfWeek = (firstDay.getDay() + 6) % 7; // Chuy·ªÉn t·ª´ CN=0 sang T2=0
            
            const calendarDays = document.getElementById('calendarDays');
            calendarDays.innerHTML = '';
            
            // Th√™m c√°c √¥ tr·ªëng cho nh·ªØng ng√†y c·ªßa th√°ng tr∆∞·ªõc
            for (let i = 0; i < startingDayOfWeek; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'w-8 h-8';
                calendarDays.appendChild(emptyDay);
            }
            
            // Th√™m c√°c ng√†y trong th√°ng
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'w-8 h-8 flex items-center justify-center text-xs rounded cursor-pointer hover:bg-gray-100';
                dayElement.textContent = day;
                
                // T√¥ ƒë·∫≠m ng√†y h√¥m nay
                if (day === today) {
                    dayElement.className += ' bg-blue-500 text-white font-bold hover:bg-blue-600';
                }
                
                calendarDays.appendChild(dayElement);
            }
        }

        // ƒê·∫øm k√Ω t·ª± trong textarea
        document.getElementById('teacherInput').addEventListener('input', function() {
            const remaining = 1500 - this.value.length;
            document.getElementById('charCount').textContent = remaining;
            document.getElementById('charCount').style.color = remaining < 100 ? '#ef4444' : '#6b7280';
        });

        // Ch·ª©c nƒÉng ch·ªçn ·∫£nh
        function selectImage() {
            document.getElementById('imageInput').click();
        }

        // X·ª≠ l√Ω khi t·∫£i ·∫£nh l√™n
        function handleImageUpload(event) {
            const file = event.target.files[0];
            if (file) {
                // Ki·ªÉm tra k√≠ch th∆∞·ªõc file (t·ªëi ƒëa 10MB)
                if (file.size > 10 * 1024 * 1024) {
                    alert('·∫¢nh qu√° l·ªõn! Vui l√≤ng ch·ªçn ·∫£nh nh·ªè h∆°n 10MB.');
                    return;
                }
                
                // Ki·ªÉm tra ƒë·ªãnh d·∫°ng file
                if (!file.type.startsWith('image/')) {
                    alert('Vui l√≤ng ch·ªçn file ·∫£nh!');
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    // T·∫°o canvas ƒë·ªÉ x·ª≠ l√Ω ·∫£nh ch·∫•t l∆∞·ª£ng cao
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // ƒê·∫∑t k√≠ch th∆∞·ªõc canvas ƒë·ªÉ gi·ªØ ch·∫•t l∆∞·ª£ng cao
                        const maxSize = 512; // K√≠ch th∆∞·ªõc t·ªëi ƒëa
                        let { width, height } = img;
                        
                        // T√≠nh to√°n k√≠ch th∆∞·ªõc m·ªõi gi·ªØ t·ª∑ l·ªá
                        if (width > height) {
                            if (width > maxSize) {
                                height = (height * maxSize) / width;
                                width = maxSize;
                            }
                        } else {
                            if (height > maxSize) {
                                width = (width * maxSize) / height;
                                height = maxSize;
                            }
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // V·∫Ω ·∫£nh v·ªõi ch·∫•t l∆∞·ª£ng cao
                        ctx.imageSmoothingEnabled = true;
                        ctx.imageSmoothingQuality = 'high';
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // Chuy·ªÉn ƒë·ªïi th√†nh data URL ch·∫•t l∆∞·ª£ng cao
                        const highQualityDataUrl = canvas.toDataURL('image/jpeg', 0.95);
                        
                        const avatarImg = document.getElementById('userAvatar');
                        const avatarEmoji = document.getElementById('avatarDisplay');
                        
                        avatarImg.src = highQualityDataUrl;
                        avatarImg.classList.remove('hidden');
                        avatarEmoji.classList.add('hidden');
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(file);
            }
        }

        // Ch·ª©c nƒÉng thay ƒë·ªïi avatar emoji
        function changeAvatar() {
            const avatars = ['üì∏', 'üòä', 'üåü', 'üíñ', 'üéâ', 'üå∏', 'ü¶Ñ', 'üåà', '‚≠ê', 'üí´', 'üé®', 'üé≠', 'üé™', 'üéØ', 'üé≤'];
            const currentAvatar = document.getElementById('avatarDisplay').textContent;
            let newAvatar;
            do {
                newAvatar = avatars[Math.floor(Math.random() * avatars.length)];
            } while (newAvatar === currentAvatar);
            
            // ·∫®n ·∫£nh v√† hi·ªán emoji
            document.getElementById('userAvatar').classList.add('hidden');
            document.getElementById('avatarDisplay').classList.remove('hidden');
            document.getElementById('avatarDisplay').textContent = newAvatar;
        }

        // Kh·ªüi t·∫°o
        updateStats();

        // ƒê√≥ng modal khi nh·∫•n ESC
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeModal();
            }
        });

        // ƒê√≥ng modal khi click b√™n ngo√†i
        document.getElementById('editModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'982a9b15a04addbc',t:'MTc1ODQ2ODY0Ny4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>




